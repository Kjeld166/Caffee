<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <title>Getränke bestellen</title>
  <style>
    body { font-family: sans-serif; padding: 20px; }
    .drink { border:1px solid #ccc; margin:10px 0; padding:10px; border-radius:10px; }
    img { max-width:100px; display:block; margin-bottom:5px; }
    button { margin-top:5px; padding:5px 10px; }
    #addBtn { margin-bottom:20px; padding:10px 15px; background:#4CAF50; color:white; border:none; cursor:pointer; }
  </style>
</head>
<body>
  <h1>Getränke bestellen</h1>
  <button id="addBtn" onclick="window.location.href='add.html'">➕ Getränk hinzufügen</button>
  <div id="drinkList"></div>

  <script type="module">
    import { db } from "./firebase.js";
    import { collection, onSnapshot, addDoc, serverTimestamp } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-firestore.js";

    const drinkList = document.getElementById("drinkList");

    // Getränke live aus Firebase anzeigen
    const drinksRef = collection(db, "drinks");
    onSnapshot(drinksRef, snapshot => {
      drinkList.innerHTML = "";
      snapshot.forEach(docSnap => {
        const d = docSnap.data();
        const div = document.createElement("div");
        div.className = "drink";
        div.innerHTML = `
          <img src="${d.image}" alt="${d.name}">
          <strong>${d.name}</strong><br>
          <em>${d.description}</em><br>
          <button>Bestellen</button>
        `;
        div.querySelector("button").onclick = async () => {
          await addDoc(collection(db, "orders"), {
            drinkName: d.name,
            status: "offen",
            created: serverTimestamp()
          });
          alert("Bestellung aufgegeben: " + d.name);
        };
        drinkList.appendChild(div);
      });
    });
  </script>
</body>
</html>
